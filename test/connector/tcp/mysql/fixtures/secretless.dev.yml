# This file contains just the correctly configured service configurations to
# allow developers to test the MySQL connector manually. For fixtures used by
# the automated tests, another file, 'secretless.yml' will be generated by the
# test script.
version: 2
services:
  health-check:
    protocol: ""
    connector: mysql
    listenOn: unix:///sock/mysql.sock
    credentials:
      host:
        from: literal
        get: mysql
      password:
        from: literal
        get: testpass
      username:
        from: literal
        get: testuser
    config: null
  # The following service is for connecting to the MySQL server that's on the
  # "mysql" docker compose service. This can be tested by running `mysql -h
  # secretless-dev -P 5555` from the `test` container in the docker compose
  # environment.
  mysql:
    protocol: ""
    connector: mysql
    listenOn: tcp://0.0.0.0:5555
    credentials:
      host:
        from: literal
        get: mysql
      password:
        from: literal
        get: testpass
      port:
        from: literal
        get: "3306"
      sslcert:
        from: literal
        get: ""
      sslhost:
        from: literal
        get: ""
      sslkey:
        from: literal
        get: ""
      sslmode:
        from: literal
        get: ""
      sslrootcert:
        from: file
        get: /secretless/test/util/ssl/ca.pem
      username:
        from: literal
        get: testuser
    config: null
  # The following service is for connecting to the MySQL server that's on the
  # "mysql_no_tls" docker compose service. This can be tested by running `mysql
  # -h secretless-dev -P 6666` from the `test` container in the docker compose
  # environment.
  mysql_no_tls:
    protocol: ""
    connector: mysql
    listenOn: tcp://0.0.0.0:6666
    credentials:
      host:
        from: literal
        get: mysql_no_tls
      password:
        from: literal
        get: testpass
      port:
        from: literal
        get: "3306"
      sslcert:
        from: literal
        get: ""
      sslhost:
        from: literal
        get: ""
      sslkey:
        from: literal
        get: ""
      sslmode:
        from: literal
        get: disable
      sslrootcert:
        from: literal
        get: ""
      username:
        from: literal
        get: testuser
    config: null