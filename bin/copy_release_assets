#!/usr/bin/env bash

set -eo pipefail

print_help() {
    echo "About $0: Copies release files into Github release asset directory."
    echo "Usage: $0 path/to/asset/release/directory"
    exit 1
}

asset_dir="$1"
goreleaser_dir="pristine-checkout/dist/goreleaser/"

if [[ ! -d "${asset_dir}" ]]; then
    echo "${asset_dir} directory does not exist."
    print_help
fi

assets=(
    "NOTICES.txt"
    "CHANGELOG.md"
    "LICENSE"
    "${goreleaser_dir}"**/*arm64
    "${goreleaser_dir}"**/*amd64
    "${goreleaser_dir}"*.tar.gz
    "${goreleaser_dir}"*.rpm
    "${goreleaser_dir}"*.deb
    "${goreleaser_dir}SHA256SUMS.txt"
    )

for asset in "${assets[@]}"; do
    echo "Copying ${asset} to ${asset_dir}"
    cp "${asset}" "${asset_dir}"
done
